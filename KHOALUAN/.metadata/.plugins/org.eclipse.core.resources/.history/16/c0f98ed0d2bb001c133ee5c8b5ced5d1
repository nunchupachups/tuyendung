package cntt.trang.dao;

import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Iterator;
import java.util.Set;
import org.json.simple.JSONObject;
import org.json.simple.parser.JSONParser;
import org.json.simple.parser.ParseException;


public class DocJSON {
	Connection conn =null;
	PreparedStatement ps = null;
	ResultSet rs= null;
	
	public static void main(String[] args) {
		JSONParser jsonParser = new JSONParser();

        try (FileReader reader = new FileReader("C:\\Users\\Admin\\Desktop\\KHOALUAN\\TuyenDungSV\\src\\main\\webapp\\json\\tinh_tp.json")) {
            // Read JSON file
            Object obj = jsonParser.parse(reader);

            JSONObject userList = (JSONObject) obj;
            Set<String> keys=userList.keySet();
            Iterator<String> keyIt=keys.iterator();
            while(keyIt.hasNext()) {
            	JSONObject hi= (JSONObject)userList.get(keyIt.next());
                String code=(String) hi.get("code");
                String name=(String) hi.get("name");
                String type=(String) hi.get("type");
                System.out.println(code);
                System.out.println(name);
                System.out.println(type);
            }
            
  

        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } catch (ParseException e) {
            e.printStackTrace();
        }
	}
	public int insertTinhThanh(String maTinhThanh, String tenTinhThanh, String type) throws SQLException {
		int flag= -1;
		String query = "insert into TinhThanh(MaTinhThanh,TenTinhThanh,Type) values(?,?,?)";
		try {
			conn = new DBConnect().getConnection();
			ps = conn.prepareStatement(query);
			ps.setNString(1, maTinhThanh);
			ps.setNString(2, tenTinhThanh);
			ps.setNString(3, type);
			
			flag= ps.executeUpdate();	
		} catch (Exception e) {
			e.printStackTrace();
		}
		finally {
			if(rs!=null) {
				rs.close();
			}
			if(ps!=null) {
				ps.close();
			}
			if(conn!=null) {
				conn.close();
			}	
		}
		return flag;
	}

}

package cntt.trang.controller;


import java.io.BufferedOutputStream;
import java.io.File;
import java.io.FileOutputStream;
import java.io.PrintWriter;
import java.util.ArrayList;
import java.util.Date;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.multipart.commons.CommonsMultipartFile;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;

import cntt.trang.bean.CV;
import cntt.trang.bean.ChungChi;
import cntt.trang.bean.DoanhNghiep;
import cntt.trang.bean.DonVi;
import cntt.trang.bean.KyNang;
import cntt.trang.bean.SinhVien;
import cntt.trang.bean.ViTri;
import cntt.trang.dao.CVDAO;
import cntt.trang.dao.ChungChiDAO;
import cntt.trang.dao.DoanhNghiepDAO;
import cntt.trang.dao.DonViDAO;
import cntt.trang.dao.KyNangDAO;
import cntt.trang.dao.NganhDaoTaoDAO;
import cntt.trang.dao.QuangBaDAO;
import cntt.trang.dao.SinhVienDAO;
import cntt.trang.dao.ViTriDAO;


@Controller
@RequestMapping(value = "/sinhvien")
public class SinhVienController {
	@RequestMapping(value= {"","/timkiem"}, method=RequestMethod.GET)
    public String tuyenDung(Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
	 		NganhDaoTaoDAO nganhDaoTaoDAO= new NganhDaoTaoDAO();
	 		
	 		model.addAttribute("dsNganhDaoTao", nganhDaoTaoDAO.getAllNganhDaoTao());
	    	return "sinhvien/timkiemsinhvien";
		} catch (Exception e) {
			e.getStackTrace();
			return null;
		}
       
    }
	@RequestMapping(value= {"/dangnhap"}, method=RequestMethod.GET)
    public String displayDangNhap(Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
	 		model.addAttribute("title", "Đăng nhập tài khoản sinh viên");
	    	return "sinhvien/dangnhap";
		} catch (Exception e) {
			e.getStackTrace();
			return null;
		}
       
    }
	
	@RequestMapping(value= {"/dangnhap"}, method=RequestMethod.POST)
    public String dangNhap(Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
	 		SinhVienDAO sinhVienDAO = new SinhVienDAO();
	 		
	 		String maSinhVien=request.getParameter("txtMaSinhVien");
	 		
	 		
	 		if(sinhVienDAO.KiemTraDangNhap(maSinhVien)!= null) {
	 			SinhVien sinhvien= sinhVienDAO.KiemTraDangNhap(maSinhVien);
	 			session.setAttribute("sinhvien",sinhvien);
	 			
	 			return "trangchu";
	 		}
	 		else model.addAttribute("msg", "Mã sinh viên hoặc mật khẩu sai");
	 		
	 		model.addAttribute("title", "Đăng nhập tài khoản sinh viên");
	    	return "sinhvien/dangnhap";
		} catch (Exception e) {
			e.getStackTrace();
			return null;
		}
       
    }
	@RequestMapping(value= {"/dangxuat"}, method=RequestMethod.GET)
    public String dangXuat(Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
	 		session.removeAttribute("sinhvien");
	 		return "redirect:/doanhnghiep";
	 		
		} catch (Exception e) {
			e.getStackTrace();
			return null;
		}
       
    }
	@RequestMapping(value= {"/CV"}, method=RequestMethod.GET)
    public String displayCV(Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
	 		SinhVien sinhVien= (SinhVien)session.getAttribute("sinhvien");
	 		CVDAO cvdao = new CVDAO();
	 		KyNangDAO kyNangDAO= new KyNangDAO();
	 		DonViDAO donViDAO= new DonViDAO();
	 		ViTriDAO viTriDAO=new ViTriDAO();
	 		ChungChiDAO chungChiDAO=new ChungChiDAO();
	 		
	 		ArrayList<ChungChi> chungChis= chungChiDAO.getAllChungChiByMaCV(sinhVien.getMaSinhVien());
	 		ArrayList<DonVi> hocVans= donViDAO.getAllDonViByMucCVAndMaCV("hocvan", sinhVien.getMaSinhVien());
	 		ArrayList<DonVi> kinhNghiems= donViDAO.getAllDonViByMucCVAndMaCV("kinhnghiemlamviec", sinhVien.getMaSinhVien());
	 		ArrayList<DonVi> hoatDongs= donViDAO.getAllDonViByMucCVAndMaCV("hoatdong", sinhVien.getMaSinhVien());
	 		ArrayList<KyNang> kynangs= kyNangDAO.getAllKyNangByMaCV(sinhVien.getMaSinhVien());
	 		CV cv=cvdao.getCVByMaSinhVien(sinhVien.getMaSinhVien());
	 		model.addAttribute("sinhVien", sinhVien);
	 		model.addAttribute("cv", cv);
	 		model.addAttribute("kynangs", kynangs);
	 		model.addAttribute("hocVans", hocVans);
	 		model.addAttribute("kinhNghiems", kinhNghiems);
	 		model.addAttribute("hoatDongs", hoatDongs);
	 		model.addAttribute("viTriDAO", viTriDAO);
	 		model.addAttribute("chungChis", chungChis);
	 		
	 		return "sinhvien/CV/show";
	 		
		} catch (Exception e) {
			e.getStackTrace();
			return null;
		}
       
    }
	@RequestMapping(value= {"/suaCV"}, method=RequestMethod.GET)
    public String taoCV(Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
	 		SinhVien sinhVien= (SinhVien)session.getAttribute("sinhvien");
	 		CVDAO cvdao = new CVDAO();
	 		KyNangDAO kyNangDAO= new KyNangDAO();
	 		DonViDAO donViDAO= new DonViDAO();
	 		ViTriDAO viTriDAO=new ViTriDAO();
	 		ChungChiDAO chungChiDAO=new ChungChiDAO();
	 		
	 		ArrayList<DonVi> hocVans=donViDAO.getAllDonViByMucCVAndMaCV("hocvan", sinhVien.getMaSinhVien());
	 		ArrayList<DonVi> kinhNghiems=donViDAO.getAllDonViByMucCVAndMaCV("kinhnghiemlamviec", sinhVien.getMaSinhVien());
	 		ArrayList<DonVi> hoatDongs=donViDAO.getAllDonViByMucCVAndMaCV("hoatdong", sinhVien.getMaSinhVien());
	 		ArrayList<ViTri> viTris=new ArrayList<ViTri>();
	 		ArrayList<ViTri> viTriTam= null;
	 		for (DonVi dv : hocVans) {
				viTriTam=viTriDAO.getAllViTriByMaDonVi(dv.getMaDonVi());
				for (ViTri viTri : viTriTam) {
					viTris.add(viTri);
				}
			}
	 		for (DonVi dv : kinhNghiems) {
				viTriTam=viTriDAO.getAllViTriByMaDonVi(dv.getMaDonVi());
				for (ViTri viTri : viTriTam) {
					viTris.add(viTri);
				}
			}
	 		for (DonVi dv : hoatDongs) {
				viTriTam=viTriDAO.getAllViTriByMaDonVi(dv.getMaDonVi());
				for (ViTri viTri : viTriTam) {
					viTris.add(viTri);
				}
			}
	 		
	 		
	 		session.setAttribute("hocVans",hocVans );
	 		session.setAttribute("hoatDongs", hoatDongs);
	 		session.setAttribute("kinhNghiems",kinhNghiems );
	 		session.setAttribute("viTris", viTris);
	 		session.setAttribute("kyNangs", kyNangDAO.getAllKyNangByMaCV(sinhVien.getMaSinhVien()));
	 		session.setAttribute("chungChis", chungChiDAO.getAllChungChiByMaCV(sinhVien.getMaSinhVien()));
	 		session.setAttribute("cv", cvdao.getCVByMaSinhVien(sinhVien.getMaSinhVien()));
	 		
	 		model.addAttribute("sinhVien", sinhVien);
	 		model.addAttribute("viTriDAO", viTriDAO);
	 		
	 		
	 		return "sinhvien/CV/sua";
	 		
		} catch (Exception e) {
			e.getStackTrace();
			return null;
		}
       
    }
	@RequestMapping(value= {"/suaCV"}, method=RequestMethod.POST)
    public String suaCV(@RequestParam("avatar") CommonsMultipartFile anhDaiDien,@RequestParam("position") String viTriUngTuyen,
    		@RequestParam("soThich") String soThich,
    		 @RequestParam("mucTieuNgheNghiep") String mucTieuNgheNghiep, @RequestParam("showKyNang") String showKyNang, 
    		 @RequestParam("showSoThich") String showSoThich, @RequestParam("showChungChi") String showChungChi, 
    		 @RequestParam("showMucTieuNgheNghiep") String showMucTieuNgheNghiep, @RequestParam("showHocVan") String showHocVan, 
    		 @RequestParam("showKinhNghiemLamViec") String showKinhNghiemLamViec, @RequestParam("showHoatDong") String showHoatDong, 
    		Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response, RedirectAttributes redirectAttributes) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
//			String absolutefilePath=request.getServletContext().getRealPath("/image");
//			File dir = new File(absolutefilePath);
//			if(!dir.exists()) {
//				dir.mkdirs();
//			}
//			
//	 		byte[] bytes=hinhAnhDaiDien.getBytes();
//			Date date=new Date();
//			String name="anh"+date.getTime()+hinhAnhDaiDien.getOriginalFilename().substring(hinhAnhDaiDien.getOriginalFilename().indexOf("."));
//			File uploadfile=new File(dir.getAbsolutePath()+"\\"+name);
//			BufferedOutputStream outputStream=new BufferedOutputStream(new FileOutputStream(uploadfile));
//			outputStream.write(bytes);
//			outputStream.close();
//			String anh ="image/"+name;
//				
//			DoanhNghiep doanhnghiep=(DoanhNghiep)session.getAttribute("doanhnghiep");
//			QuangBaDAO quangBaDAO=new QuangBaDAO();
//			int kq=quangBaDAO.insertQuangBa(tieuDe, noiDungDaiDien, anh, baiViet, false, doanhnghiep.getMaDoanhNghiep());
//			
//			if(kq!=-1) redirectAttributes.addFlashAttribute("msg1", "Thêm bài quảng bá thành công!");
//			else redirectAttributes.addFlashAttribute("msg2", "Thêm bài quảng bá thất bại!");
	 		System.out.println("anhDaiDien "+anhDaiDien);
	 		System.out.println("viTriUngTuyen "+viTriUngTuyen);
	 		System.out.println("soThich "+soThich);
	 		System.out.println("mucTieuNgheNghiep "+mucTieuNgheNghiep);
	 		System.out.println("showKyNang "+showKyNang);
	 		System.out.println("showMucTieuNgheNghiep "+showMucTieuNgheNghiep);
	 		System.out.println("showKinhNghiemLamViec "+showKinhNghiemLamViec);
	 		System.out.println("showHocVan "+showHocVan);
	 		System.out.println("showHoatDong "+showHoatDong);
	 		System.out.println("showSoThich "+showSoThich);
	 		System.out.println("showChungChi "+showChungChi);
			return "redirect:/sinhvien/CV";
		} catch (Exception e) {
			e.printStackTrace();
			return null;
		}
       
    }
    @RequestMapping(value= {"/suaCV/addkynang"}, method=RequestMethod.POST)
    public void addKyNang(Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
	 		KyNangDAO kyNangDAO= new KyNangDAO();
	 		String tenKyNang= request.getParameter("tenKyNang");
	 		String doThanhThao= request.getParameter("doThanhThao");
	 		
	 		ArrayList<KyNang> kyNangs=(ArrayList<KyNang>)session.getAttribute("kyNangs");
	 		SinhVien sinhvien=(SinhVien)session.getAttribute("sinhvien");
	 		long maKyNang=0;
	 		for (KyNang kn : kyNangDAO.getAllKyNang()) {
				if(kn.getMaKyNang()>maKyNang) maKyNang=kn.getMaKyNang();
			}
	 		kyNangs.add(new KyNang(maKyNang+1, tenKyNang, Integer.parseInt(doThanhThao), sinhvien.getMaSinhVien()));
	 		session.removeAttribute("kyNangs");
	 		session.setAttribute("kyNangs", kyNangs);
	 		PrintWriter out=response.getWriter();
	 		
	 		for (KyNang kn : kyNangs) {
	 			System.out.println(kn.getMaKyNang()+ " - "+kn.getTenKyNang()+" - "+kn.getDoThanhThao());
	 		}
	 		for (KyNang kn : kyNangs) {
				out.print("<div class=\"row mb-1\">\r\n" + 
						"	                                <div class=\"col-6\">\r\n" + 
							                                    kn.getTenKyNang()+ 
						"	                                </div>\r\n" + 
						"	                                <div class=\"col-5\">\r\n" + 
						"	                                    Thành thạo: "+ kn.getDoThanhThao() +"/10\r\n" + 
						"	                                </div>\r\n" + 
						"	                                <div class=\"col-1\">\r\n" + 
						"	                                    <i class=\"fas fa-trash-alt trash\" onclick=\"deleteKyNang('"+kn.getMaKyNang()+"')\"></i>" + 
						"	                                </div>\r\n" + 
						"	                            </div>");
			}
	 		out.print("<a href=\"\" data-bs-toggle=\"modal\" data-bs-target=\"#myModalKynang\"><i\r\n" + 
	 				"                                    class=\"fas fa-plus-square\"></i>Thêm kỹ năng</a>");
	 		
		} catch (Exception e) {
			e.getStackTrace();
			
		}
       
    }
    @RequestMapping(value= {"/suaCV/deletekynang"}, method=RequestMethod.POST)
    public void deleteKyNang(Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
	 		String maKyNang= request.getParameter("maKyNang");
	 		
	 		ArrayList<KyNang> kyNangs=(ArrayList<KyNang>)session.getAttribute("kyNangs");
	 		
	 		KyNang kyNang = null;
	 		for (KyNang kn : kyNangs) {
				if(kn.getMaKyNang()==Long.parseLong(maKyNang)) kyNang=kn;
			}
	 		kyNangs.remove(kyNang);
	 		session.removeAttribute("kyNangs");
	 		session.setAttribute("kyNangs", kyNangs);
	 		for (KyNang kn : kyNangs) {
	 			System.out.println(kn.getMaKyNang()+ " - "+kn.getTenKyNang()+" - "+kn.getDoThanhThao());
	 		}
	 		System.out.println("ok");
	 		PrintWriter out=response.getWriter();
	 		
	 		if(!kyNangs.isEmpty()) {
				for (KyNang kn : kyNangs) { 
					out.print("<div class=\"row mb-1\">\r\n" + 
							"	                                <div class=\"col-6\">\r\n" + 
							kn.getTenKyNang()+ 
							"	                                </div>\r\n" + 
							"	                                <div class=\"col-5\">\r\n" + 
							"	                                    Thành thạo: "+ kn.getDoThanhThao() +"/10\r\n" + 
							"	                                </div>\r\n" + 
							"	                                <div class=\"col-1\">\r\n" + 
							"	                                    <i class=\"fas fa-trash-alt trash\" onclick=\"deleteKyNang('"+kn.getMaKyNang()+"')\"></i>" + 
							"	                                </div>\r\n" + 
							"	                            </div>"); 
				}
				
	 		}
	 			
	 		out.print("<a href=\"\" data-bs-toggle=\"modal\" data-bs-target=\"#myModalKynang\"><i\r\n" + 
	 				"                                    class=\"fas fa-plus-square\"></i>Thêm kỹ năng</a>");
	 		
		} catch (Exception e) {
			e.printStackTrace();
			
		}
       
    }
    @RequestMapping(value= {"/suaCV/addChungChi"}, method=RequestMethod.POST)
    public void addChungChi(Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
	 		ChungChiDAO chungChiDAO = new ChungChiDAO();
	 		String tenChungChi= request.getParameter("tenChungChi");
	 		String nam= request.getParameter("nam");
	 		
	 		ArrayList<ChungChi> chungChis=(ArrayList<ChungChi>)session.getAttribute("chungChis");
	 		SinhVien sinhvien=(SinhVien)session.getAttribute("sinhvien");
	 		long maChungChi=0;
	 		for (ChungChi cc : chungChiDAO.getAllChungChi()) {
				if(cc.getMaChungChi()>maChungChi) maChungChi=cc.getMaChungChi();
			}
	 		chungChis.add(new ChungChi(maChungChi+1, tenChungChi, nam, sinhvien.getMaSinhVien()));
	 		session.removeAttribute("chungChis");
	 		session.setAttribute("chungChis", chungChis);
	 		PrintWriter out=response.getWriter();
	 		
	 		
	 		for (ChungChi cc : chungChis) {
				out.print("<div class=\"row mb-1\">\r\n" + 
						"	                                <div class=\"col-6\">\r\n" + cc.getTenChungChi() + 
						"	                                </div>\r\n" + 
						"	                                <div class=\"col-5\">\r\n" + 
						"	                                    Năm:  "+cc.getNam() + 
						"	                                </div>\r\n" + 
						"	\r\n" + 
						"	                                <div class=\"col-1\">\r\n" + 
						"	                                    <i class=\"fas fa-trash-alt trash\" onclick=\"deleteChungChi('"+cc.getMaChungChi()+"')\"></i>\r\n" + 
						"	                                </div>\r\n" + 
						"	                            </div>");
			}
	 		out.print("<a href=\"\" data-bs-toggle=\"modal\" data-bs-target=\"#myModalChungchi\"><i\r\n" + 
	 				"                                    class=\"fas fa-plus-square\"></i>Thêm chứng chỉ</a>");
	 		
		} catch (Exception e) {
			e.getStackTrace();
			
		}
       
    }
    @RequestMapping(value= {"/suaCV/deleteChungChi"}, method=RequestMethod.POST)
    public void deleteChungChi(Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
	 		String maChungChi= request.getParameter("maChungChi");
	 		
	 		ArrayList<ChungChi> chungChis=(ArrayList<ChungChi>)session.getAttribute("chungChis");
	 		
	 		ChungChi chungChi = null;
	 		for (ChungChi cc : chungChis) {
				if(cc.getMaChungChi()==Long.parseLong(maChungChi)) chungChi=cc;
			}
	 		chungChis.remove(chungChi);
	 		session.removeAttribute("chungChis");
	 		session.setAttribute("chungChis", chungChis);
	 		
	 		PrintWriter out=response.getWriter();
	 		
	 		if(!chungChis.isEmpty()) {
	 			for (ChungChi cc : chungChis) {
					out.print("<div class=\"row mb-1\">\r\n" + 
							"	                                <div class=\"col-6\">\r\n" + cc.getTenChungChi() + 
							"	                                </div>\r\n" + 
							"	                                <div class=\"col-5\">\r\n" + 
							"	                                    Năm:  "+cc.getNam() + 
							"	                                </div>\r\n" + 
							"	\r\n" + 
							"	                                <div class=\"col-1\">\r\n" + 
							"	                                    <i class=\"fas fa-trash-alt trash\" onclick=\"deleteChungChi('"+cc.getMaChungChi()+"')\"></i>\r\n" + 
							"	                                </div>\r\n" + 
							"	                            </div>");
				}
	 		}
	 			
	 		out.print("<a href=\"\" data-bs-toggle=\"modal\" data-bs-target=\"#myModalChungchi\"><i\r\n" + 
	 				"                                    class=\"fas fa-plus-square\"></i>Thêm chứng chỉ</a>");
		} catch (Exception e) {
			e.printStackTrace();
			
		}
       
    }
    @RequestMapping(value= {"/suaCV/addViTriHocVan"}, method=RequestMethod.POST)
    public void addViTriHocVan(Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
	 		String tenViTri= request.getParameter("viTri");
	 		String khoangThoiGian= request.getParameter("khoangThoiGian");
	 		String moTa= request.getParameter("moTa");
	 		String maDonVi= request.getParameter("maDonVi");
	 		
	 		ArrayList<ViTri> viTris=(ArrayList<ViTri>)session.getAttribute("viTris");
	 		ArrayList<DonVi> hocVans=(ArrayList<DonVi>)session.getAttribute("hocVans");
	 		ViTriDAO viTriDAO=new ViTriDAO();
	 		
	 		long maViTri=0;
	 		for (ViTri vt : viTriDAO.getAllViTri()) {
				if(vt.getMaViTri()>maViTri) maViTri=vt.getMaViTri();
			}
	 		for (ViTri vt : viTris) {
	 			if(vt.getMaViTri()>maViTri) maViTri=vt.getMaViTri();
			}
	 		viTris.add(new ViTri(maViTri+1, tenViTri, khoangThoiGian, Long.parseLong(maDonVi), moTa));
	 		
	 		
	 		for (DonVi donVi : hocVans) {
				System.out.println(donVi.getMaDonVi()+" - "+donVi.getTenDonVi());
			}
	 		System.out.println("--------------------------");
	 		for (ViTri vt : viTris) {
				System.out.println(vt.getMaDonVi()+" - "+vt.getMaViTri()+" - "+vt.getTenViTri()+" - "+vt.getKhoangThoiGian()+" - "+vt.getMoTa());
			}
	 		System.out.println("--------------------------");
	 		session.removeAttribute("viTris");
	 		session.setAttribute("viTris", viTris);
	 		
	 		PrintWriter out=response.getWriter();
	 		
	 		if(!hocVans.isEmpty()) {
	 			out.print("<ul >");
				for (DonVi hv : hocVans) { 
					out.print("<li>\r\n" + 
							"			                                <div class=\"row\">\r\n" + 
							"			                                	<div class=\"col-11\">\r\n" + 
							"			                                		<b>"+hv.getTenDonVi()+"</b>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                	<div class=\"col-1\">\r\n" + 
							"			                                		<i class=\"fas fa-trash-alt trash\" onclick=\"deleteHocVan('"+hv.getMaDonVi()+"')\"></i>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                </div>"); 
					for(ViTri vt:viTris) {
						if(vt.getMaDonVi()==hv.getMaDonVi()) {
							out.print("<div class=\"row mb-3\">\r\n" + 
									"				                                	<div class=\"col-11\">\r\n" + 
									"				                                    <div class=\"row mb-2\"    >\r\n" + 
									"				                                        <div class=\"col-9\"> <b><i>"+vt.getTenViTri() +"</i></b> "+
									"				                                        </div>\r\n" + 
									"				                                        <div class=\"col-3\">\r\n" + vt.getKhoangThoiGian() + 
									"				                                        </div>\r\n" + 
									"				                                        \r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div style=\"margin-left: 20px;\">\r\n" + vt.getMoTa() + 
									"				                                    </div>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div class=\"col-1\">\r\n" + 
									"				                                    	<i class=\"fas fa-trash-alt trash\" onclick=\"deleteViTriHocVan('"+vt.getMaViTri()+"')\"></i>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                </div>");
						}
					}
					out.print("<a href=\"\" data-bs-toggle=\"modal\" data-bs-target=\"#myModalViTriHocVan"+hv.getMaDonVi()+"\"><i class=\"fas fa-plus-square\"></i> Thêm ngành, vị trí học tập</a>\r\n" + 
							"			                            	<!-- The Modal vi tri Hoc Van-->\r\n" + 
							"								                <div class=\"modal\" id=\"myModalViTriHocVan"+hv.getMaDonVi() +"\">\r\n" + 
							"								                    <div class=\"modal-dialog\">\r\n" + 
							"								                        <div class=\"modal-content\">\r\n" + 
							"								\r\n" + 
							"								                            <!-- Modal Header -->\r\n" + 
							"								                            <div class=\"modal-header\">\r\n" + 
							"								                                <h4 class=\"modal-title\">Thêm Vị Trí Học Vấn</h4>\r\n" + 
							"								                                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\r\n" + 
							"								                            </div>\r\n" + 
							"								\r\n" + 
							"								                            <!-- Modal body -->\r\n" + 
							"								                            <form >\r\n" + 
							"								                            <div class=\"modal-body\">\r\n" + 
							"								                                \r\n" + 
							"								                                    <div class=\"mb-3 mt-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Vị trí<span class=\"required\">\r\n" + 
							"                                        												*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtViTriHocVan"+hv.getMaDonVi()+"\" placeholder=\"Sinh viên ngành Công nghệ thông tin\">\r\n" + 
							"								                                    </div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Khoảng thời gian<span class=\"required\">\r\n" + 
							"                                        														*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtKhoangThoiGianHocVan"+hv.getMaDonVi() +"\" placeholder=\"2018 - Nay\">\r\n" + 
							"								                                    </div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Mô tả:</label>\r\n" + 
							"								                                        <textarea id=\"txtMoTaHocVan"+hv.getMaDonVi() +"\" rows=\"5\" cols=\"20\" class=\"form-control\"></textarea>" + 
							"								                                    </div>\r\n" + 
							"								                                  \r\n" + 
							"								                            </div>\r\n" + 
							"								\r\n" + 
							"								                            <!-- Modal footer -->\r\n" + 
							"								                            <div class=\"modal-footer\">\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-primary\" onclick=\"addViTriHocVan('"+hv.getMaDonVi() +"')\">Thêm</button>\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-danger\" data-bs-dismiss=\"modal\">Close</button>\r\n" + 
							"								                                \r\n" + 
							"								                            </div>\r\n" + 
							"															</form>\r\n" + 
							"								                        </div>\r\n" + 
							"								                    </div>\r\n" + 
							"								                </div>\r\n" + 
							"			                            </li>");
					
				}
				out.print("</ul>");
	 		}
	 		
		} catch (Exception e) {
			e.printStackTrace();
			
		}
       
    }
    @RequestMapping(value= {"/suaCV/addViTriLamViec"}, method=RequestMethod.POST)
    public void addViTriLamViec(Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
	 		String tenViTri= request.getParameter("viTri");
	 		String khoangThoiGian= request.getParameter("khoangThoiGian");
	 		String moTa= request.getParameter("moTa");
	 		String maDonVi= request.getParameter("maDonVi");
	 		
	 		ArrayList<ViTri> viTris=(ArrayList<ViTri>)session.getAttribute("viTris");
	 		ArrayList<DonVi> kinhNghiems=(ArrayList<DonVi>)session.getAttribute("kinhNghiems");
	 		ViTriDAO viTriDAO=new ViTriDAO();
	 		
	 		long maViTri=0;
	 		for (ViTri vt : viTriDAO.getAllViTri()) {
				if(vt.getMaViTri()>maViTri) maViTri=vt.getMaViTri();
			}
	 		for (ViTri vt : viTris) {
	 			if(vt.getMaViTri()>maViTri) maViTri=vt.getMaViTri();
			}
	 		viTris.add(new ViTri(maViTri+1, tenViTri, khoangThoiGian, Long.parseLong(maDonVi), moTa));
	 		
	 		
	 		for (DonVi donVi : kinhNghiems) {
				System.out.println(donVi.getMaDonVi()+" - "+donVi.getTenDonVi());
			}
	 		System.out.println("--------------------------");
	 		for (ViTri vt : viTris) {
				System.out.println(vt.getMaDonVi()+" - "+vt.getMaViTri()+" - "+vt.getTenViTri()+" - "+vt.getKhoangThoiGian()+" - "+vt.getMoTa());
			}
	 		System.out.println("--------------------------");
	 		session.removeAttribute("viTris");
	 		session.setAttribute("viTris", viTris);
	 		
	 		PrintWriter out=response.getWriter();
	 		
	 		if(!kinhNghiems.isEmpty()) {
	 			out.print("<ul >");
				for (DonVi kn : kinhNghiems) { 
					out.print("<li>\r\n" + 
							"			                                <div class=\"row\">\r\n" + 
							"			                                	<div class=\"col-11\">\r\n" + 
							"			                                		<b>"+kn.getTenDonVi() +"</b>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                	<div class=\"col-1\">\r\n" + 
							"			                                		<i class=\"fas fa-trash-alt trash\" onclick=\"deleteKinhNghiem('"+kn.getMaDonVi()+"')\"></i>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                </div>"); 
					for(ViTri vt:viTris) {
						if(vt.getMaDonVi()==kn.getMaDonVi()) {
							out.print("<div class=\"row mb-3\">\r\n" + 
									"				                                	<div class=\"col-11\">\r\n" + 
									"				                                    <div class=\"row mb-2\"    >\r\n" + 
									"				                                        <div class=\"col-9\">\r\n" + 
									"				                                           <b><i>"+vt.getTenViTri() +"</i></b> \r\n" + 
									"				                                        </div>\r\n" + 
									"				                                        <div class=\"col-3\">\r\n" + vt.getKhoangThoiGian() + 
									"				                                        </div>\r\n" + 
									"				                                        \r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div style=\"margin-left: 20px;\">\r\n" + vt.getMoTa()  + 
									"				                                    </div>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div class=\"col-1\">\r\n" + 
									"				                                    	<i class=\"fas fa-trash-alt trash\" onclick=\"deleteViTriLamViec('"+vt.getMaViTri()+"')\"></i>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                </div>");
						}
					}
					out.print("<a href=\"\" data-bs-toggle=\"modal\" data-bs-target=\"#myModalViTriLamViec"+kn.getMaDonVi() +"\"><i class=\"fas fa-plus-square\"></i> Thêm vị trí, chức vụ làm việc</a>\r\n" + 
							"			                            	<!-- The Modal vi tri Lam Viec-->\r\n" + 
							"							                <div class=\"modal\" id=\"myModalViTriLamViec"+kn.getMaDonVi() +"\">\r\n" + 
							"							                    <div class=\"modal-dialog\">\r\n" + 
							"							                        <div class=\"modal-content\">\r\n" + 
							"							                            <!-- Modal Header -->\r\n" + 
							"							                            <div class=\"modal-header\">\r\n" + 
							"							                                <h4 class=\"modal-title\">Thêm Vị Trí Làm Việc</h4>\r\n" + 
							"							                                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\r\n" + 
							"							                            </div>\r\n" + 
							"							                            <!-- Modal body -->\r\n" + 
							"							                            <form >\r\n" + 
							"								                            <div class=\"modal-body\">\r\n" + 
							"								                                    <div class=\"mb-3 mt-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Vị trí<span class=\"required\">\r\n" + 
							"                                        												*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtViTriLamViec"+kn.getMaDonVi() +"\" placeholder=\"Trưởng phòng nhân sự\">\r\n" + 
							"								                                    <small id=\"errorViTriLamViec\" class=\"required\"></small></div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Khoảng thời gian<span class=\"required\">\r\n" + 
							"                                        														*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtKhoangThoiGianLamViec"+kn.getMaDonVi() +"\" placeholder=\"2018 - Nay\">\r\n" + 
							"								                                    <small id=\"errorKhoangThoiGianLamViec\" class=\"required\"></small></div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Mô tả:</label>\r\n" + 
							"								                                        <textarea id=\"txtMoTaLamViec"+kn.getMaDonVi() +"\" rows=\"5\" cols=\"20\" class=\"form-control\"></textarea>\r\n" + 
							"								                                    </div>\r\n" + 
							"								                                  \r\n" + 
							"								                            </div>\r\n" + 
							"								                            <!-- Modal footer -->\r\n" + 
							"								                            <div class=\"modal-footer\">\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-primary\" onclick=\"addViTriLamViec('"+kn.getMaDonVi() +"')\">Thêm</button>\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-danger\" data-bs-dismiss=\"modal\">Close</button>\r\n" + 
							"								                            </div>\r\n" + 
							"															</form>\r\n" + 
							"							\r\n" + 
							"							                        </div>\r\n" + 
							"							                    </div>\r\n" + 
							"							                </div>\r\n" + 
							"			                            </li>");
					
				}
				out.print("</ul>");
	 		}
	 		
		} catch (Exception e) {
			e.printStackTrace();
			
		}
       
    }
    @RequestMapping(value= {"/suaCV/addViTriHoatDong"}, method=RequestMethod.POST)
    public void addViTriHoatDong(Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
	 		String tenViTri= request.getParameter("viTri");
	 		String khoangThoiGian= request.getParameter("khoangThoiGian");
	 		String moTa= request.getParameter("moTa");
	 		String maDonVi= request.getParameter("maDonVi");
	 		
	 		ArrayList<ViTri> viTris=(ArrayList<ViTri>)session.getAttribute("viTris");
	 		ArrayList<DonVi> hoatDongs=(ArrayList<DonVi>)session.getAttribute("hoatDongs");
	 		ViTriDAO viTriDAO=new ViTriDAO();
	 		
	 		long maViTri=0;
	 		for (ViTri vt : viTriDAO.getAllViTri()) {
				if(vt.getMaViTri()>maViTri) maViTri=vt.getMaViTri();
			}
	 		for (ViTri vt : viTris) {
	 			if(vt.getMaViTri()>maViTri) maViTri=vt.getMaViTri();
			}
	 		viTris.add(new ViTri(maViTri+1, tenViTri, khoangThoiGian, Long.parseLong(maDonVi), moTa));
	 		
	 		
	 		for (DonVi donVi : hoatDongs) {
				System.out.println(donVi.getMaDonVi()+" - "+donVi.getTenDonVi());
			}
	 		System.out.println("--------------------------");
	 		for (ViTri vt : viTris) {
				System.out.println(vt.getMaDonVi()+" - "+vt.getMaViTri()+" - "+vt.getTenViTri()+" - "+vt.getKhoangThoiGian()+" - "+vt.getMoTa());
			}
	 		System.out.println("--------------------------");
	 		session.removeAttribute("viTris");
	 		session.setAttribute("viTris", viTris);
	 		
	 		PrintWriter out=response.getWriter();
	 		
	 		if(!hoatDongs.isEmpty()) {
	 			out.print("<ul >");
				for (DonVi hd : hoatDongs) { 
					out.print("<li>\r\n" + 
							"			                                <div class=\"row\">\r\n" + 
							"			                                	<div class=\"col-11\">\r\n" + 
							"			                                		<b>"+hd.getTenDonVi() +"</b>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                	<div class=\"col-1\">\r\n" + 
							"			                                		<i class=\"fas fa-trash-alt trash\" onclick=\"deleteHoatDong('"+hd.getMaDonVi()+"')\"></i>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                </div>"); 
					for(ViTri vt:viTris) {
						if(vt.getMaDonVi()==hd.getMaDonVi()) {
							out.print("<div class=\"row mb-3\">\r\n" + 
									"				                                	<div class=\"col-11\">\r\n" + 
									"				                                    <div class=\"row mb-2\"    >\r\n" + 
									"				                                        <div class=\"col-9\">\r\n" + 
									"				                                           <b><i>"+vt.getTenViTri() +"</i></b> \r\n" + 
									"				                                        </div>\r\n" + 
									"				                                        <div class=\"col-3\">\r\n" + vt.getKhoangThoiGian()  + 
									"				                                        </div>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div style=\"margin-left: 20px;\">\r\n" + vt.getMoTa()  + 
									"				                                    </div>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div class=\"col-1\">\r\n" + 
									"				                                    	<i class=\"fas fa-trash-alt trash\" onclick=\"deleteViTriHoatDong('"+vt.getMaViTri()+"')\"></i>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                </div>");
						}
					}
					out.print("<a href=\"\" data-bs-toggle=\"modal\" data-bs-target=\"#myModalViTriHoatDong"+hd.getMaDonVi() +"\"><i class=\"fas fa-plus-square\"></i> Thêm nhóm, bộ phận, chức vụ hoạt động</a>\r\n" + 
							"			                            	<!-- The Modal vi tri Hoc Van-->\r\n" + 
							"								                <div class=\"modal\" id=\"myModalViTriHoatDong"+hd.getMaDonVi() +"\">\r\n" + 
							"								                    <div class=\"modal-dialog\">\r\n" + 
							"								                        <div class=\"modal-content\">\r\n" + 
							"								                            <!-- Modal Header -->\r\n" + 
							"								                            <div class=\"modal-header\">\r\n" + 
							"								                                <h4 class=\"modal-title\">Thêm Vị Trí Hoạt Động</h4>\r\n" + 
							"								                                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\r\n" + 
							"								                            </div>\r\n" + 
							"								                            <!-- Modal body -->\r\n" + 
							"								                            <form >\r\n" + 
							"								                            <div class=\"modal-body\">\r\n" + 
							"								                                    <div class=\"mb-3 mt-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Vị trí<span class=\"required\">\r\n" + 
							"                                        												*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtViTriHoatDong"+hd.getMaDonVi() +"\" placeholder=\"Trưởng ban văn nghệ\">\r\n" + 
							"								                                    </div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Khoảng thời gian<span class=\"required\">\r\n" + 
							"                                        														*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtKhoangThoiGianHoatDong"+hd.getMaDonVi() +"\" placeholder=\"2018 - Nay\">\r\n" + 
							"								                                    </div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Mô tả:</label>\r\n" + 
							"								                                        <textarea id=\"txtMoTaHoatDong"+hd.getMaDonVi() +"\" rows=\"5\" cols=\"20\" class=\"form-control\"></textarea>\r\n" + 
							"								                                    </div>\r\n" + 
							"								                            </div>\r\n" + 
							"								                            <!-- Modal footer -->\r\n" + 
							"								                            <div class=\"modal-footer\">\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-primary\" onclick=\"addViTriHoatDong('"+hd.getMaDonVi() +"')\">Thêm</button>\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-danger\" data-bs-dismiss=\"modal\">Close</button>\r\n" + 
							"								                                \r\n" + 
							"								                            </div>\r\n" + 
							"															</form>\r\n" + 
							"								                        </div>\r\n" + 
							"								                    </div>\r\n" + 
							"								                </div>\r\n" + 
							"			                            </li>");
					
				}
				out.print("</ul>");
	 		}
	 		
		} catch (Exception e) {
			e.printStackTrace();
			
		}
       
    }
    @RequestMapping(value= {"/suaCV/addTruongHoc"}, method=RequestMethod.POST)
    public void addTruongHoc(Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
	 		String tenDonVi= request.getParameter("tenDonVi");

	 		System.out.println(tenDonVi);
	 		ArrayList<ViTri> viTris=(ArrayList<ViTri>)session.getAttribute("viTris");
	 		ArrayList<DonVi> hocVans=(ArrayList<DonVi>)session.getAttribute("hocVans");
	 		ArrayList<DonVi> kinhNghiems=(ArrayList<DonVi>)session.getAttribute("kinhNghiems");
	 		ArrayList<DonVi> hoatDongs=(ArrayList<DonVi>)session.getAttribute("hoatDongs");
	 		SinhVien sinhVien=(SinhVien)session.getAttribute("sinhvien");
	 		
	 		DonViDAO donViDAO=new DonViDAO();
	 		
	 		long maDonVi=0;
	 		for (DonVi dv : donViDAO.getAllDonVi()) {
				if(dv.getMaDonVi()>maDonVi) maDonVi=dv.getMaDonVi();
			}
	 		for (DonVi dv : hocVans) {
				if(dv.getMaDonVi()>maDonVi) maDonVi=dv.getMaDonVi();
			}
	 		for (DonVi dv : kinhNghiems) {
				if(dv.getMaDonVi()>maDonVi) maDonVi=dv.getMaDonVi();
			}
	 		for (DonVi dv : hoatDongs) {
				if(dv.getMaDonVi()>maDonVi) maDonVi=dv.getMaDonVi();
			}
	 		hocVans.add(new DonVi(maDonVi+1, tenDonVi, sinhVien.getMaSinhVien(), "hocvan"));
	 		session.removeAttribute("hocVans");
	 		session.setAttribute("hocVans", hocVans);
	 		
	 		for (DonVi donVi : hocVans) {
				System.out.println(donVi.getMaDonVi()+" - "+donVi.getTenDonVi());
			}
	 		System.out.println("--------------------------");
	 		for (ViTri vt : viTris) {
				System.out.println(vt.getMaDonVi()+" - "+vt.getMaViTri()+" - "+vt.getTenViTri()+" - "+vt.getKhoangThoiGian()+" - "+vt.getMoTa());
			}
	 		System.out.println("--------------------------");
	 		
	 		PrintWriter out=response.getWriter();
	 		
	 		if(!hocVans.isEmpty()) {
	 			out.print("<ul >");
				for (DonVi hv : hocVans) { 
					out.print("<li>\r\n" + 
							"			                                <div class=\"row\">\r\n" + 
							"			                                	<div class=\"col-11\">\r\n" + 
							"			                                		<b>"+hv.getTenDonVi()+"</b>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                	<div class=\"col-1\">\r\n" + 
							"			                                		<i class=\"fas fa-trash-alt trash\" onclick=\"deleteHocVan('"+hv.getMaDonVi()+"')\"></i>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                </div>"); 
					for(ViTri vt:viTris) {
						if(vt.getMaDonVi()==hv.getMaDonVi()) {
							out.print("<div class=\"row mb-3\">\r\n" + 
									"				                                	<div class=\"col-11\">\r\n" + 
									"				                                    <div class=\"row mb-2\"    >\r\n" + 
									"				                                        <div class=\"col-9\"> <b><i>"+vt.getTenViTri() +"</i></b> "+
									"				                                        </div>\r\n" + 
									"				                                        <div class=\"col-3\">\r\n" + vt.getKhoangThoiGian() + 
									"				                                        </div>\r\n" + 
									"				                                        \r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div style=\"margin-left: 20px;\">\r\n" + vt.getMoTa() + 
									"				                                    </div>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div class=\"col-1\">\r\n" + 
									"				                                    	<i class=\"fas fa-trash-alt trash\" onclick=\"deleteViTriHocVan('"+vt.getMaViTri()+"')\"></i>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                </div>");
						}
					}
					out.print("<a href=\"\" data-bs-toggle=\"modal\" data-bs-target=\"#myModalViTriHocVan"+hv.getMaDonVi()+"\"><i class=\"fas fa-plus-square\"></i> Thêm ngành, vị trí học tập</a>\r\n" + 
							"			                            	<!-- The Modal vi tri Hoc Van-->\r\n" + 
							"								                <div class=\"modal\" id=\"myModalViTriHocVan"+hv.getMaDonVi() +"\">\r\n" + 
							"								                    <div class=\"modal-dialog\">\r\n" + 
							"								                        <div class=\"modal-content\">\r\n" + 
							"								\r\n" + 
							"								                            <!-- Modal Header -->\r\n" + 
							"								                            <div class=\"modal-header\">\r\n" + 
							"								                                <h4 class=\"modal-title\">Thêm Vị Trí Học Vấn</h4>\r\n" + 
							"								                                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\r\n" + 
							"								                            </div>\r\n" + 
							"								\r\n" + 
							"								                            <!-- Modal body -->\r\n" + 
							"								                            <form >\r\n" + 
							"								                            <div class=\"modal-body\">\r\n" + 
							"								                                \r\n" + 
							"								                                    <div class=\"mb-3 mt-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Vị trí<span class=\"required\">\r\n" + 
							"                                        												*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtViTriHocVan"+hv.getMaDonVi()+"\" placeholder=\"Sinh viên ngành Công nghệ thông tin\">\r\n" + 
							"								                                    <small id=\"errorViTriHocVan\" class=\"required\"></small></div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Khoảng thời gian<span class=\"required\">\r\n" + 
							"                                        														*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtKhoangThoiGianHocVan"+hv.getMaDonVi() +"\" placeholder=\"2018 - Nay\">\r\n" + 
							"								                                    <small id=\"errorKhoangThoiGianHocVan\" class=\"required\"></small></div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Mô tả:</label>\r\n" + 
							"								                                        <textarea id=\"txtMoTaHocVan"+hv.getMaDonVi() +"\" rows=\"5\" cols=\"20\" class=\"form-control\"></textarea>" + 
							"								                                    </div>\r\n" + 
							"								                                  \r\n" + 
							"								                            </div>\r\n" + 
							"								\r\n" + 
							"								                            <!-- Modal footer -->\r\n" + 
							"								                            <div class=\"modal-footer\">\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-primary\" onclick=\"addViTriHocVan('"+hv.getMaDonVi() +"')\">Thêm</button>\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-danger\" data-bs-dismiss=\"modal\">Close</button>\r\n" + 
							"								                                \r\n" + 
							"								                            </div>\r\n" + 
							"															</form>\r\n" + 
							"								                        </div>\r\n" + 
							"								                    </div>\r\n" + 
							"								                </div>\r\n" + 
							"			                            </li>");
					
				}
				out.print("</ul>");
	 		}
	 		
		} catch (Exception e) {
			e.printStackTrace();
			
		}
       
    }
    @RequestMapping(value= {"/suaCV/addCongTy"}, method=RequestMethod.POST)
    public void addCongTy(Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
	 		String tenDonVi= request.getParameter("tenDonVi");

	 		System.out.println(tenDonVi);
	 		ArrayList<ViTri> viTris=(ArrayList<ViTri>)session.getAttribute("viTris");
	 		ArrayList<DonVi> hocVans=(ArrayList<DonVi>)session.getAttribute("hocVans");
	 		ArrayList<DonVi> kinhNghiems=(ArrayList<DonVi>)session.getAttribute("kinhNghiems");
	 		ArrayList<DonVi> hoatDongs=(ArrayList<DonVi>)session.getAttribute("hoatDongs");
	 		SinhVien sinhVien=(SinhVien)session.getAttribute("sinhvien");
	 		
	 		DonViDAO donViDAO=new DonViDAO();
	 		
	 		long maDonVi=0;
	 		for (DonVi dv : donViDAO.getAllDonVi()) {
				if(dv.getMaDonVi()>maDonVi) maDonVi=dv.getMaDonVi();
			}
	 		for (DonVi dv : hocVans) {
				if(dv.getMaDonVi()>maDonVi) maDonVi=dv.getMaDonVi();
			}
	 		for (DonVi dv : kinhNghiems) {
				if(dv.getMaDonVi()>maDonVi) maDonVi=dv.getMaDonVi();
			}
	 		for (DonVi dv : hoatDongs) {
				if(dv.getMaDonVi()>maDonVi) maDonVi=dv.getMaDonVi();
			}
	 		kinhNghiems.add(new DonVi(maDonVi+1, tenDonVi, sinhVien.getMaSinhVien(), "kinhnghiemlamviec"));
	 		session.removeAttribute("kinhNghiems");
	 		session.setAttribute("kinhNghiems", kinhNghiems);
	 		
	 		PrintWriter out=response.getWriter();
	 		
	 		if(!kinhNghiems.isEmpty()) {
	 			out.print("<ul >");
				for (DonVi kn : kinhNghiems) { 
					out.print("<li>\r\n" + 
							"			                                <div class=\"row\">\r\n" + 
							"			                                	<div class=\"col-11\">\r\n" + 
							"			                                		<b>"+kn.getTenDonVi() +"</b>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                	<div class=\"col-1\">\r\n" + 
							"			                                		<i class=\"fas fa-trash-alt trash\" onclick=\"deleteKinhNghiem('"+kn.getMaDonVi()+"')\"></i>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                </div>"); 
					for(ViTri vt:viTris) {
						if(vt.getMaDonVi()==kn.getMaDonVi()) {
							out.print("<div class=\"row mb-3\">\r\n" + 
									"				                                	<div class=\"col-11\">\r\n" + 
									"				                                    <div class=\"row mb-2\"    >\r\n" + 
									"				                                        <div class=\"col-9\">\r\n" + 
									"				                                           <b><i>"+vt.getTenViTri() +"</i></b> \r\n" + 
									"				                                        </div>\r\n" + 
									"				                                        <div class=\"col-3\">\r\n" + vt.getKhoangThoiGian() + 
									"				                                        </div>\r\n" + 
									"				                                        \r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div style=\"margin-left: 20px;\">\r\n" + vt.getMoTa()  + 
									"				                                    </div>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div class=\"col-1\">\r\n" + 
									"				                                    	<i class=\"fas fa-trash-alt trash\" onclick=\"deleteViTriLamViec('"+vt.getMaViTri()+"')\"></i>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                </div>");
						}
					}
					out.print("<a href=\"\" data-bs-toggle=\"modal\" data-bs-target=\"#myModalViTriLamViec"+kn.getMaDonVi() +"\"><i class=\"fas fa-plus-square\"></i> Thêm vị trí, chức vụ làm việc</a>\r\n" + 
							"			                            	<!-- The Modal vi tri Lam Viec-->\r\n" + 
							"							                <div class=\"modal\" id=\"myModalViTriLamViec"+kn.getMaDonVi() +"\">\r\n" + 
							"							                    <div class=\"modal-dialog\">\r\n" + 
							"							                        <div class=\"modal-content\">\r\n" + 
							"							                            <!-- Modal Header -->\r\n" + 
							"							                            <div class=\"modal-header\">\r\n" + 
							"							                                <h4 class=\"modal-title\">Thêm Vị Trí Làm Việc</h4>\r\n" + 
							"							                                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\r\n" + 
							"							                            </div>\r\n" + 
							"							                            <!-- Modal body -->\r\n" + 
							"							                            <form >\r\n" + 
							"								                            <div class=\"modal-body\">\r\n" + 
							"								                                    <div class=\"mb-3 mt-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Vị trí<span class=\"required\">\r\n" + 
							"                                        												*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtViTriLamViec"+kn.getMaDonVi() +"\" placeholder=\"Trưởng phòng nhân sự\">\r\n" + 
							"								                                    <small id=\"errorViTriLamViec\" class=\"required\"></small></div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Khoảng thời gian<span class=\"required\">\r\n" + 
							"                                        														*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtKhoangThoiGianLamViec"+kn.getMaDonVi() +"\" placeholder=\"2018 - Nay\">\r\n" + 
							"								                                   <small id=\"errorKhoangThoiGianLamViec\" class=\"required\"></small></div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Mô tả:</label>\r\n" + 
							"								                                        <textarea id=\"txtMoTaLamViec"+kn.getMaDonVi() +"\" rows=\"5\" cols=\"20\" class=\"form-control\"></textarea>\r\n" + 
							"								                                    </div>\r\n" + 
							"								                                  \r\n" + 
							"								                            </div>\r\n" + 
							"								                            <!-- Modal footer -->\r\n" + 
							"								                            <div class=\"modal-footer\">\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-primary\" onclick=\"addViTriLamViec('"+kn.getMaDonVi() +"')\">Thêm</button>\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-danger\" data-bs-dismiss=\"modal\">Close</button>\r\n" + 
							"								                            </div>\r\n" + 
							"															</form>\r\n" + 
							"							\r\n" + 
							"							                        </div>\r\n" + 
							"							                    </div>\r\n" + 
							"							                </div>\r\n" + 
							"			                            </li>");
					
				}
				out.print("</ul>");
	 		}
	 		
		} catch (Exception e) {
			e.printStackTrace();
			
		}
       
    }
    @RequestMapping(value= {"/suaCV/addHoatDong"}, method=RequestMethod.POST)
    public void addHoatDong(Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
	 		String tenDonVi= request.getParameter("tenDonVi");

	 		System.out.println(tenDonVi);
	 		ArrayList<ViTri> viTris=(ArrayList<ViTri>)session.getAttribute("viTris");
	 		ArrayList<DonVi> hocVans=(ArrayList<DonVi>)session.getAttribute("hocVans");
	 		ArrayList<DonVi> kinhNghiems=(ArrayList<DonVi>)session.getAttribute("kinhNghiems");
	 		ArrayList<DonVi> hoatDongs=(ArrayList<DonVi>)session.getAttribute("hoatDongs");
	 		SinhVien sinhVien=(SinhVien)session.getAttribute("sinhvien");
	 		
	 		DonViDAO donViDAO=new DonViDAO();
	 		
	 		long maDonVi=0;
	 		for (DonVi dv : donViDAO.getAllDonVi()) {
				if(dv.getMaDonVi()>maDonVi) maDonVi=dv.getMaDonVi();
			}
	 		for (DonVi dv : hocVans) {
				if(dv.getMaDonVi()>maDonVi) maDonVi=dv.getMaDonVi();
			}
	 		for (DonVi dv : kinhNghiems) {
				if(dv.getMaDonVi()>maDonVi) maDonVi=dv.getMaDonVi();
			}
	 		for (DonVi dv : hoatDongs) {
				if(dv.getMaDonVi()>maDonVi) maDonVi=dv.getMaDonVi();
			}
	 		hoatDongs.add(new DonVi(maDonVi+1, tenDonVi, sinhVien.getMaSinhVien(), "hoatdong"));
	 		session.removeAttribute("hoatDongs");
	 		session.setAttribute("hoatDongs", hoatDongs);
	 		
	 		PrintWriter out=response.getWriter();
	 		
	 		if(!hoatDongs.isEmpty()) {
	 			out.print("<ul >");
				for (DonVi hd : hoatDongs) { 
					out.print("<li>\r\n" + 
							"			                                <div class=\"row\">\r\n" + 
							"			                                	<div class=\"col-11\">\r\n" + 
							"			                                		<b>"+hd.getTenDonVi() +"</b>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                	<div class=\"col-1\">\r\n" + 
							"			                                		<i class=\"fas fa-trash-alt trash\" onclick=\"deleteHoatDong('"+hd.getMaDonVi()+"')\"></i>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                </div>"); 
					for(ViTri vt:viTris) {
						if(vt.getMaDonVi()==hd.getMaDonVi()) {
							out.print("<div class=\"row mb-3\">\r\n" + 
									"				                                	<div class=\"col-11\">\r\n" + 
									"				                                    <div class=\"row mb-2\"    >\r\n" + 
									"				                                        <div class=\"col-9\">\r\n" + 
									"				                                           <b><i>"+vt.getTenViTri() +"</i></b> \r\n" + 
									"				                                        </div>\r\n" + 
									"				                                        <div class=\"col-3\">\r\n" + vt.getKhoangThoiGian()  + 
									"				                                        </div>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div style=\"margin-left: 20px;\">\r\n" + vt.getMoTa()  + 
									"				                                    </div>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div class=\"col-1\">\r\n" + 
									"				                                    	<i class=\"fas fa-trash-alt trash\" onclick=\"deleteViTriHoatDong('"+vt.getMaViTri()+"')\"></i>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                </div>");
						}
					}
					out.print("<a href=\"\" data-bs-toggle=\"modal\" data-bs-target=\"#myModalViTriHoatDong"+hd.getMaDonVi() +"\"><i class=\"fas fa-plus-square\"></i> Thêm nhóm, bộ phận, chức vụ hoạt động</a>\r\n" + 
							"			                            	<!-- The Modal vi tri Hoc Van-->\r\n" + 
							"								                <div class=\"modal\" id=\"myModalViTriHoatDong"+hd.getMaDonVi() +"\">\r\n" + 
							"								                    <div class=\"modal-dialog\">\r\n" + 
							"								                        <div class=\"modal-content\">\r\n" + 
							"								                            <!-- Modal Header -->\r\n" + 
							"								                            <div class=\"modal-header\">\r\n" + 
							"								                                <h4 class=\"modal-title\">Thêm Vị Trí Hoạt Động</h4>\r\n" + 
							"								                                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\r\n" + 
							"								                            </div>\r\n" + 
							"								                            <!-- Modal body -->\r\n" + 
							"								                            <form >\r\n" + 
							"								                            <div class=\"modal-body\">\r\n" + 
							"								                                    <div class=\"mb-3 mt-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Vị trí<span class=\"required\">\r\n" + 
							"                                        												*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtViTriHoatDong"+hd.getMaDonVi() +"\" placeholder=\"Trưởng ban văn nghệ\">\r\n" + 
							"								                                    <small id=\"errorViTriHoatDong\" class=\"required\"></small></div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Khoảng thời gian<span class=\"required\">\r\n" + 
							"                                        														*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtKhoangThoiGianHoatDong"+hd.getMaDonVi() +"\" placeholder=\"2018 - Nay\">\r\n" + 
							"								                                    <small id=\"errorKhoangThoiGianHoatDong\" class=\"required\"></small></div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Mô tả:</label>\r\n" + 
							"								                                        <textarea id=\"txtMoTaHoatDong"+hd.getMaDonVi() +"\" rows=\"5\" cols=\"20\" class=\"form-control\"></textarea>\r\n" + 
							"								                                    </div>\r\n" + 
							"								                            </div>\r\n" + 
							"								                            <!-- Modal footer -->\r\n" + 
							"								                            <div class=\"modal-footer\">\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-primary\" onclick=\"addViTriHoatDong('"+hd.getMaDonVi() +"')\">Thêm</button>\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-danger\" data-bs-dismiss=\"modal\">Close</button>\r\n" + 
							"								                                \r\n" + 
							"								                            </div>\r\n" + 
							"															</form>\r\n" + 
							"								                        </div>\r\n" + 
							"								                    </div>\r\n" + 
							"								                </div>\r\n" + 
							"			                            </li>");
					
				}
				out.print("</ul>");
	 		}
	 		
		} catch (Exception e) {
			e.printStackTrace();
			
		}
       
    }
    @RequestMapping(value= {"/suaCV/deleteTruongHoc"}, method=RequestMethod.POST)
    public void deleteTruongHoc(Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
	 		String maDonVi= request.getParameter("maDonVi");

	 		ArrayList<ViTri> viTris=(ArrayList<ViTri>)session.getAttribute("viTris");
	 		ArrayList<DonVi> hocVans=(ArrayList<DonVi>)session.getAttribute("hocVans");
	 		
	 		DonVi donVi=null;
	 		for (DonVi dv : hocVans) {
				if(dv.getMaDonVi()==Long.parseLong(maDonVi)) donVi=dv;
			}
	 		hocVans.remove(donVi);
	 		
	 		ArrayList<ViTri> viTri=new ArrayList<ViTri>();
	 		for (ViTri vt : viTris) {
				if(vt.getMaDonVi()==Long.parseLong(maDonVi)) viTri.add(vt);
			}
	 		viTris.removeAll(viTri);
	 		
	 		session.removeAttribute("hocVans");
	 		session.setAttribute("hocVans", hocVans);
	 		session.removeAttribute("viTris");
	 		session.setAttribute("viTris", viTris);
	 		
	 		for (DonVi dv : hocVans) {
				System.out.println(dv.getMaDonVi()+" - "+dv.getTenDonVi());
			}
	 		System.out.println("--------------------------");
	 		for (ViTri vt : viTris) {
				System.out.println(vt.getMaDonVi()+" - "+vt.getMaViTri()+" - "+vt.getTenViTri()+" - "+vt.getKhoangThoiGian()+" - "+vt.getMoTa());
			}
	 		System.out.println("--------------------------");
	 		
	 		PrintWriter out=response.getWriter();
	 		
	 		if(!hocVans.isEmpty()) {
	 			out.print("<ul >");
				for (DonVi hv : hocVans) { 
					out.print("<li>\r\n" + 
							"			                                <div class=\"row\">\r\n" + 
							"			                                	<div class=\"col-11\">\r\n" + 
							"			                                		<b>"+hv.getTenDonVi()+"</b>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                	<div class=\"col-1\">\r\n" + 
							"			                                		<i class=\"fas fa-trash-alt trash\" onclick=\"deleteHocVan('"+hv.getMaDonVi()+"')\"></i>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                </div>"); 
					for(ViTri vt:viTris) {
						if(vt.getMaDonVi()==hv.getMaDonVi()) {
							out.print("<div class=\"row mb-3\">\r\n" + 
									"				                                	<div class=\"col-11\">\r\n" + 
									"				                                    <div class=\"row mb-2\"    >\r\n" + 
									"				                                        <div class=\"col-9\"> <b><i>"+vt.getTenViTri() +"</i></b> "+
									"				                                        </div>\r\n" + 
									"				                                        <div class=\"col-3\">\r\n" + vt.getKhoangThoiGian() + 
									"				                                        </div>\r\n" + 
									"				                                        \r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div style=\"margin-left: 20px;\">\r\n" + vt.getMoTa() + 
									"				                                    </div>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div class=\"col-1\">\r\n" + 
									"				                                    	<i class=\"fas fa-trash-alt trash\" onclick=\"deleteViTriHocVan('"+vt.getMaViTri()+"')\"></i>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                </div>");
						}
					}
					out.print("<a href=\"\" data-bs-toggle=\"modal\" data-bs-target=\"#myModalViTriHocVan"+hv.getMaDonVi()+"\"><i class=\"fas fa-plus-square\"></i> Thêm ngành, vị trí học tập</a>\r\n" + 
							"			                            	<!-- The Modal vi tri Hoc Van-->\r\n" + 
							"								                <div class=\"modal\" id=\"myModalViTriHocVan"+hv.getMaDonVi() +"\">\r\n" + 
							"								                    <div class=\"modal-dialog\">\r\n" + 
							"								                        <div class=\"modal-content\">\r\n" + 
							"								\r\n" + 
							"								                            <!-- Modal Header -->\r\n" + 
							"								                            <div class=\"modal-header\">\r\n" + 
							"								                                <h4 class=\"modal-title\">Thêm Vị Trí Học Vấn</h4>\r\n" + 
							"								                                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\r\n" + 
							"								                            </div>\r\n" + 
							"								\r\n" + 
							"								                            <!-- Modal body -->\r\n" + 
							"								                            <form >\r\n" + 
							"								                            <div class=\"modal-body\">\r\n" + 
							"								                                \r\n" + 
							"								                                    <div class=\"mb-3 mt-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Vị trí<span class=\"required\">\r\n" + 
							"                                        												*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtViTriHocVan"+hv.getMaDonVi()+"\" placeholder=\"Sinh viên ngành Công nghệ thông tin\">\r\n" + 
							"								                                    <small id=\"errorViTriHocVan\" class=\"required\"></small></div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Khoảng thời gian<span class=\"required\">\r\n" + 
							"                                        														*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtKhoangThoiGianHocVan"+hv.getMaDonVi() +"\" placeholder=\"2018 - Nay\">\r\n" + 
							"								                                    <small id=\"errorKhoangThoiGianHocVan\" class=\"required\"></small></div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Mô tả:</label>\r\n" + 
							"								                                        <textarea id=\"txtMoTaHocVan"+hv.getMaDonVi() +"\" rows=\"5\" cols=\"20\" class=\"form-control\"></textarea>" + 
							"								                                    </div>\r\n" + 
							"								                                  \r\n" + 
							"								                            </div>\r\n" + 
							"								\r\n" + 
							"								                            <!-- Modal footer -->\r\n" + 
							"								                            <div class=\"modal-footer\">\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-primary\" onclick=\"addViTriHocVan('"+hv.getMaDonVi() +"')\">Thêm</button>\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-danger\" data-bs-dismiss=\"modal\">Close</button>\r\n" + 
							"								                                \r\n" + 
							"								                            </div>\r\n" + 
							"															</form>\r\n" + 
							"								                        </div>\r\n" + 
							"								                    </div>\r\n" + 
							"								                </div>\r\n" + 
							"			                            </li>");
					
				}
				out.print("</ul>");
	 		}
	 		
		} catch (Exception e) {
			e.printStackTrace();
			
		}
       
    }
    @RequestMapping(value= {"/suaCV/deleteKinhNghiem"}, method=RequestMethod.POST)
    public void deleteKinhNghiem(Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
	 		String maDonVi= request.getParameter("maDonVi");

	 		ArrayList<ViTri> viTris=(ArrayList<ViTri>)session.getAttribute("viTris");
	 		ArrayList<DonVi> kinhNghiems=(ArrayList<DonVi>)session.getAttribute("kinhNghiems");
	 		
	 		DonVi donVi=null;
	 		for (DonVi dv : kinhNghiems) {
				if(dv.getMaDonVi()==Long.parseLong(maDonVi)) donVi=dv;
			}
	 		kinhNghiems.remove(donVi);
	 		
	 		ArrayList<ViTri> viTri=new ArrayList<ViTri>();
	 		for (ViTri vt : viTris) {
				if(vt.getMaDonVi()==Long.parseLong(maDonVi)) viTri.add(vt);
			}
	 		viTris.removeAll(viTri);
	 		
	 		session.removeAttribute("kinhNghiems");
	 		session.setAttribute("kinhNghiems", kinhNghiems);
	 		session.removeAttribute("viTris");
	 		session.setAttribute("viTris", viTris);
	 		
	 		PrintWriter out=response.getWriter();
	 		
	 		if(!kinhNghiems.isEmpty()) {
	 			out.print("<ul >");
				for (DonVi kn : kinhNghiems) { 
					out.print("<li>\r\n" + 
							"			                                <div class=\"row\">\r\n" + 
							"			                                	<div class=\"col-11\">\r\n" + 
							"			                                		<b>"+kn.getTenDonVi() +"</b>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                	<div class=\"col-1\">\r\n" + 
							"			                                		<i class=\"fas fa-trash-alt trash\" onclick=\"deleteKinhNghiem('"+kn.getMaDonVi()+"')\"></i>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                </div>"); 
					for(ViTri vt:viTris) {
						if(vt.getMaDonVi()==kn.getMaDonVi()) {
							out.print("<div class=\"row mb-3\">\r\n" + 
									"				                                	<div class=\"col-11\">\r\n" + 
									"				                                    <div class=\"row mb-2\"    >\r\n" + 
									"				                                        <div class=\"col-9\">\r\n" + 
									"				                                           <b><i>"+vt.getTenViTri() +"</i></b> \r\n" + 
									"				                                        </div>\r\n" + 
									"				                                        <div class=\"col-3\">\r\n" + vt.getKhoangThoiGian() + 
									"				                                        </div>\r\n" + 
									"				                                        \r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div style=\"margin-left: 20px;\">\r\n" + vt.getMoTa()  + 
									"				                                    </div>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div class=\"col-1\">\r\n" + 
									"				                                    	<i class=\"fas fa-trash-alt trash\" onclick=\"deleteViTriLamViec('"+vt.getMaViTri()+"')\"></i>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                </div>");
						}
					}
					out.print("<a href=\"\" data-bs-toggle=\"modal\" data-bs-target=\"#myModalViTriLamViec"+kn.getMaDonVi() +"\"><i class=\"fas fa-plus-square\"></i> Thêm vị trí, chức vụ làm việc</a>\r\n" + 
							"			                            	<!-- The Modal vi tri Lam Viec-->\r\n" + 
							"							                <div class=\"modal\" id=\"myModalViTriLamViec"+kn.getMaDonVi() +"\">\r\n" + 
							"							                    <div class=\"modal-dialog\">\r\n" + 
							"							                        <div class=\"modal-content\">\r\n" + 
							"							                            <!-- Modal Header -->\r\n" + 
							"							                            <div class=\"modal-header\">\r\n" + 
							"							                                <h4 class=\"modal-title\">Thêm Vị Trí Làm Việc</h4>\r\n" + 
							"							                                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\r\n" + 
							"							                            </div>\r\n" + 
							"							                            <!-- Modal body -->\r\n" + 
							"							                            <form >\r\n" + 
							"								                            <div class=\"modal-body\">\r\n" + 
							"								                                    <div class=\"mb-3 mt-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Vị trí<span class=\"required\">\r\n" + 
							"                                        												*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtViTriLamViec"+kn.getMaDonVi() +"\" placeholder=\"Trưởng phòng nhân sự\">\r\n" + 
							"								                                    <small id=\"errorViTriLamViec\" class=\"required\"></small></div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Khoảng thời gian<span class=\"required\">\r\n" + 
							"                                        														*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtKhoangThoiGianLamViec"+kn.getMaDonVi() +"\" placeholder=\"2018 - Nay\">\r\n" + 
							"								                                    <small id=\"errorKhoangThoiGianLamViec\" class=\"required\"></small></div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Mô tả:</label>\r\n" + 
							"								                                        <textarea id=\"txtMoTaLamViec"+kn.getMaDonVi() +"\" rows=\"5\" cols=\"20\" class=\"form-control\"></textarea>\r\n" + 
							"								                                    </div>\r\n" + 
							"								                                  \r\n" + 
							"								                            </div>\r\n" + 
							"								                            <!-- Modal footer -->\r\n" + 
							"								                            <div class=\"modal-footer\">\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-primary\" onclick=\"addViTriLamViec('"+kn.getMaDonVi() +"')\">Thêm</button>\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-danger\" data-bs-dismiss=\"modal\">Close</button>\r\n" + 
							"								                            </div>\r\n" + 
							"															</form>\r\n" + 
							"							\r\n" + 
							"							                        </div>\r\n" + 
							"							                    </div>\r\n" + 
							"							                </div>\r\n" + 
							"			                            </li>");
					
				}
				out.print("</ul>");
	 		}
	 		
		} catch (Exception e) {
			e.printStackTrace();
			
		}
       
    }
    @RequestMapping(value= {"/suaCV/deleteHoatDong"}, method=RequestMethod.POST)
    public void deleteHoatDong(Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
	 		String maDonVi= request.getParameter("maDonVi");

	 		ArrayList<ViTri> viTris=(ArrayList<ViTri>)session.getAttribute("viTris");
	 		ArrayList<DonVi> hoatDongs=(ArrayList<DonVi>)session.getAttribute("hoatDongs");
	 		
	 		DonVi donVi=null;
	 		for (DonVi dv : hoatDongs) {
				if(dv.getMaDonVi()==Long.parseLong(maDonVi)) donVi=dv;
			}
	 		hoatDongs.remove(donVi);
	 		
	 		ArrayList<ViTri> viTri=new ArrayList<ViTri>();
	 		for (ViTri vt : viTris) {
				if(vt.getMaDonVi()==Long.parseLong(maDonVi)) viTri.add(vt);
			}
	 		viTris.removeAll(viTri);
	 		
	 		session.removeAttribute("hoatDongs");
	 		session.setAttribute("hoatDongs", hoatDongs);
	 		session.removeAttribute("viTris");
	 		session.setAttribute("viTris", viTris);
	 		
	 		PrintWriter out=response.getWriter();
	 		
	 		if(!hoatDongs.isEmpty()) {
	 			out.print("<ul >");
				for (DonVi hd : hoatDongs) { 
					out.print("<li>\r\n" + 
							"			                                <div class=\"row\">\r\n" + 
							"			                                	<div class=\"col-11\">\r\n" + 
							"			                                		<b>"+hd.getTenDonVi() +"</b>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                	<div class=\"col-1\">\r\n" + 
							"			                                		<i class=\"fas fa-trash-alt trash\" onclick=\"deleteHoatDong('"+hd.getMaDonVi()+"')\"></i>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                </div>"); 
					for(ViTri vt:viTris) {
						if(vt.getMaDonVi()==hd.getMaDonVi()) {
							out.print("<div class=\"row mb-3\">\r\n" + 
									"				                                	<div class=\"col-11\">\r\n" + 
									"				                                    <div class=\"row mb-2\"    >\r\n" + 
									"				                                        <div class=\"col-9\">\r\n" + 
									"				                                           <b><i>"+vt.getTenViTri() +"</i></b> \r\n" + 
									"				                                        </div>\r\n" + 
									"				                                        <div class=\"col-3\">\r\n" + vt.getKhoangThoiGian()  + 
									"				                                        </div>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div style=\"margin-left: 20px;\">\r\n" + vt.getMoTa()  + 
									"				                                    </div>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div class=\"col-1\">\r\n" + 
									"				                                    	<i class=\"fas fa-trash-alt trash\" onclick=\"deleteViTriHoatDong('"+vt.getMaViTri()+"')\"></i>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                </div>");
						}
					}
					out.print("<a href=\"\" data-bs-toggle=\"modal\" data-bs-target=\"#myModalViTriHoatDong"+hd.getMaDonVi() +"\"><i class=\"fas fa-plus-square\"></i> Thêm nhóm, bộ phận, chức vụ hoạt động</a>\r\n" + 
							"			                            	<!-- The Modal vi tri Hoc Van-->\r\n" + 
							"								                <div class=\"modal\" id=\"myModalViTriHoatDong"+hd.getMaDonVi() +"\">\r\n" + 
							"								                    <div class=\"modal-dialog\">\r\n" + 
							"								                        <div class=\"modal-content\">\r\n" + 
							"								                            <!-- Modal Header -->\r\n" + 
							"								                            <div class=\"modal-header\">\r\n" + 
							"								                                <h4 class=\"modal-title\">Thêm Vị Trí Hoạt Động</h4>\r\n" + 
							"								                                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\r\n" + 
							"								                            </div>\r\n" + 
							"								                            <!-- Modal body -->\r\n" + 
							"								                            <form >\r\n" + 
							"								                            <div class=\"modal-body\">\r\n" + 
							"								                                    <div class=\"mb-3 mt-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Vị trí<span class=\"required\">\r\n" + 
							"                                        												*</span></label>\r\n" + 
							"								                                        <small id=\"errorViTriHoatDong\" class=\"required\"></small><input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtViTriHoatDong"+hd.getMaDonVi() +"\" placeholder=\"Trưởng ban văn nghệ\">\r\n" + 
							"								                                    </div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Khoảng thời gian<span class=\"required\">\r\n" + 
							"                                        														*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtKhoangThoiGianHoatDong"+hd.getMaDonVi() +"\" placeholder=\"2018 - Nay\">\r\n" + 
							"								                                    <small id=\"errorKhoangThoiGianHoatDong\" class=\"required\"></small></div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Mô tả:</label>\r\n" + 
							"								                                        <textarea id=\"txtMoTaHoatDong"+hd.getMaDonVi() +"\" rows=\"5\" cols=\"20\" class=\"form-control\"></textarea>\r\n" + 
							"								                                    </div>\r\n" + 
							"								                            </div>\r\n" + 
							"								                            <!-- Modal footer -->\r\n" + 
							"								                            <div class=\"modal-footer\">\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-primary\" onclick=\"addViTriHoatDong('"+hd.getMaDonVi() +"')\">Thêm</button>\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-danger\" data-bs-dismiss=\"modal\">Close</button>\r\n" + 
							"								                                \r\n" + 
							"								                            </div>\r\n" + 
							"															</form>\r\n" + 
							"								                        </div>\r\n" + 
							"								                    </div>\r\n" + 
							"								                </div>\r\n" + 
							"			                            </li>");
					
				}
				out.print("</ul>");
	 		}
	 		
		} catch (Exception e) {
			e.printStackTrace();
			
		}
       
    }
    @RequestMapping(value= {"/suaCV/deleteViTriHocVan"}, method=RequestMethod.POST)
    public void deleteViTriHocVan(Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
	 		String maViTri= request.getParameter("maViTri");
	 		System.out.println(maViTri);
	 		ArrayList<ViTri> viTris=(ArrayList<ViTri>)session.getAttribute("viTris");
	 		ArrayList<DonVi> hocVans=(ArrayList<DonVi>)session.getAttribute("hocVans");
	 		
	 		ViTri viTri=null;
	 		for (ViTri vt : viTris) {
				if(vt.getMaViTri()==Long.parseLong(maViTri)) viTri=vt;
			}
	 		viTris.remove(viTri);
	 		session.removeAttribute("viTris");
	 		session.setAttribute("viTris", viTris);
	 		
	 		for (DonVi donVi : hocVans) {
				System.out.println(donVi.getMaDonVi()+" - "+donVi.getTenDonVi());
			}
	 		System.out.println("--------------------------");
	 		for (ViTri vt : viTris) {
				System.out.println(vt.getMaDonVi()+" - "+vt.getMaViTri()+" - "+vt.getTenViTri()+" - "+vt.getKhoangThoiGian()+" - "+vt.getMoTa());
			}
	 		System.out.println("--------------------------");
	 		
	 		PrintWriter out=response.getWriter();
	 		
	 		if(!hocVans.isEmpty()) {
	 			out.print("<ul >");
				for (DonVi hv : hocVans) { 
					out.print("<li>\r\n" + 
							"			                                <div class=\"row\">\r\n" + 
							"			                                	<div class=\"col-11\">\r\n" + 
							"			                                		<b>"+hv.getTenDonVi()+"</b>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                	<div class=\"col-1\">\r\n" + 
							"			                                		<i class=\"fas fa-trash-alt trash\" onclick=\"deleteHocVan('"+hv.getMaDonVi()+"')\"></i>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                </div>"); 
					for(ViTri vt:viTris) {
						if(vt.getMaDonVi()==hv.getMaDonVi()) {
							out.print("<div class=\"row mb-3\">\r\n" + 
									"				                                	<div class=\"col-11\">\r\n" + 
									"				                                    <div class=\"row mb-2\"    >\r\n" + 
									"				                                        <div class=\"col-9\"> <b><i>"+vt.getTenViTri() +"</i></b> "+
									"				                                        </div>\r\n" + 
									"				                                        <div class=\"col-3\">\r\n" + vt.getKhoangThoiGian() + 
									"				                                        </div>\r\n" + 
									"				                                        \r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div style=\"margin-left: 20px;\">\r\n" + vt.getMoTa() + 
									"				                                    </div>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div class=\"col-1\">\r\n" + 
									"				                                    	<i class=\"fas fa-trash-alt trash\" onclick=\"deleteViTriHocVan('"+vt.getMaViTri()+"')\"></i>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                </div>");
						}
					}
					out.print("<a href=\"\" data-bs-toggle=\"modal\" data-bs-target=\"#myModalViTriHocVan"+hv.getMaDonVi()+"\"><i class=\"fas fa-plus-square\"></i> Thêm ngành, vị trí học tập</a>\r\n" + 
							"			                            	<!-- The Modal vi tri Hoc Van-->\r\n" + 
							"								                <div class=\"modal\" id=\"myModalViTriHocVan"+hv.getMaDonVi() +"\">\r\n" + 
							"								                    <div class=\"modal-dialog\">\r\n" + 
							"								                        <div class=\"modal-content\">\r\n" + 
							"								\r\n" + 
							"								                            <!-- Modal Header -->\r\n" + 
							"								                            <div class=\"modal-header\">\r\n" + 
							"								                                <h4 class=\"modal-title\">Thêm Vị Trí Học Vấn</h4>\r\n" + 
							"								                                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\r\n" + 
							"								                            </div>\r\n" + 
							"								\r\n" + 
							"								                            <!-- Modal body -->\r\n" + 
							"								                            <form >\r\n" + 
							"								                            <div class=\"modal-body\">\r\n" + 
							"								                                \r\n" + 
							"								                                    <div class=\"mb-3 mt-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Vị trí<span class=\"required\">\r\n" + 
							"                                        												*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtViTriHocVan"+hv.getMaDonVi()+"\" placeholder=\"Sinh viên ngành Công nghệ thông tin\">\r\n" + 
							"								                                    <small id=\"errorViTriHocVan\" class=\"required\"></small></div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Khoảng thời gian<span class=\"required\">\r\n" + 
							"                                        														*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtKhoangThoiGianHocVan"+hv.getMaDonVi() +"\" placeholder=\"2018 - Nay\">\r\n" + 
							"								                                    <small id=\"errorKhoangThoiGianHocVan\" class=\"required\"></small></div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Mô tả:</label>\r\n" + 
							"								                                        <textarea id=\"txtMoTaHocVan"+hv.getMaDonVi() +"\" rows=\"5\" cols=\"20\" class=\"form-control\"></textarea>" + 
							"								                                    </div>\r\n" + 
							"								                                  \r\n" + 
							"								                            </div>\r\n" + 
							"								\r\n" + 
							"								                            <!-- Modal footer -->\r\n" + 
							"								                            <div class=\"modal-footer\">\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-primary\" onclick=\"addViTriHocVan('"+hv.getMaDonVi() +"')\">Thêm</button>\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-danger\" data-bs-dismiss=\"modal\">Close</button>\r\n" + 
							"								                                \r\n" + 
							"								                            </div>\r\n" + 
							"															</form>\r\n" + 
							"								                        </div>\r\n" + 
							"								                    </div>\r\n" + 
							"								                </div>\r\n" + 
							"			                            </li>");
					
				}
				out.print("</ul>");
	 		}
	 		
		} catch (Exception e) {
			e.printStackTrace();
			
		}
       
    }
    @RequestMapping(value= {"/suaCV/deleteViTriLamViec"}, method=RequestMethod.POST)
    public void deleteViTriLamViec(Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
	 		String maViTri= request.getParameter("maViTri");
	 		System.out.println(maViTri);
	 		ArrayList<ViTri> viTris=(ArrayList<ViTri>)session.getAttribute("viTris");
	 		ArrayList<DonVi> kinhNghiems=(ArrayList<DonVi>)session.getAttribute("kinhNghiems");
	 		
	 		ViTri viTri=null;
	 		for (ViTri vt : viTris) {
				if(vt.getMaViTri()==Long.parseLong(maViTri)) viTri=vt;
			}
	 		viTris.remove(viTri);
	 		session.removeAttribute("viTris");
	 		session.setAttribute("viTris", viTris);
	 		
	 		PrintWriter out=response.getWriter();
	 		
	 		if(!kinhNghiems.isEmpty()) {
	 			out.print("<ul >");
				for (DonVi kn : kinhNghiems) { 
					out.print("<li>\r\n" + 
							"			                                <div class=\"row\">\r\n" + 
							"			                                	<div class=\"col-11\">\r\n" + 
							"			                                		<b>"+kn.getTenDonVi() +"</b>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                	<div class=\"col-1\">\r\n" + 
							"			                                		<i class=\"fas fa-trash-alt trash\" onclick=\"deleteKinhNghiem('"+kn.getMaDonVi()+"')\"></i>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                </div>"); 
					for(ViTri vt:viTris) {
						if(vt.getMaDonVi()==kn.getMaDonVi()) {
							out.print("<div class=\"row mb-3\">\r\n" + 
									"				                                	<div class=\"col-11\">\r\n" + 
									"				                                    <div class=\"row mb-2\"    >\r\n" + 
									"				                                        <div class=\"col-9\">\r\n" + 
									"				                                           <b><i>"+vt.getTenViTri() +"</i></b> \r\n" + 
									"				                                        </div>\r\n" + 
									"				                                        <div class=\"col-3\">\r\n" + vt.getKhoangThoiGian() + 
									"				                                        </div>\r\n" + 
									"				                                        \r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div style=\"margin-left: 20px;\">\r\n" + vt.getMoTa()  + 
									"				                                    </div>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div class=\"col-1\">\r\n" + 
									"				                                    	<i class=\"fas fa-trash-alt trash\" onclick=\"deleteViTriLamViec('"+vt.getMaViTri()+"')\"></i>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                </div>");
						}
					}
					out.print("<a href=\"\" data-bs-toggle=\"modal\" data-bs-target=\"#myModalViTriLamViec"+kn.getMaDonVi() +"\"><i class=\"fas fa-plus-square\"></i> Thêm vị trí, chức vụ làm việc</a>\r\n" + 
							"			                            	<!-- The Modal vi tri Lam Viec-->\r\n" + 
							"							                <div class=\"modal\" id=\"myModalViTriLamViec"+kn.getMaDonVi() +"\">\r\n" + 
							"							                    <div class=\"modal-dialog\">\r\n" + 
							"							                        <div class=\"modal-content\">\r\n" + 
							"							                            <!-- Modal Header -->\r\n" + 
							"							                            <div class=\"modal-header\">\r\n" + 
							"							                                <h4 class=\"modal-title\">Thêm Vị Trí Làm Việc</h4>\r\n" + 
							"							                                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\r\n" + 
							"							                            </div>\r\n" + 
							"							                            <!-- Modal body -->\r\n" + 
							"							                            <form >\r\n" + 
							"								                            <div class=\"modal-body\">\r\n" + 
							"								                                    <div class=\"mb-3 mt-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Vị trí<span class=\"required\">\r\n" + 
							"                                        												*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtViTriLamViec"+kn.getMaDonVi() +"\" placeholder=\"Trưởng phòng nhân sự\">\r\n" + 
							"								                                    <small id=\"errorViTriLamViec\" class=\"required\"></small></div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Khoảng thời gian<span class=\"required\">\r\n" + 
							"                                        														*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtKhoangThoiGianLamViec"+kn.getMaDonVi() +"\" placeholder=\"2018 - Nay\">\r\n" + 
							"								                                    <small id=\"errorKhoangThoiGianLamViec\" class=\"required\"></small></div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Mô tả:</label>\r\n" + 
							"								                                        <textarea id=\"txtMoTaLamViec"+kn.getMaDonVi() +"\" rows=\"5\" cols=\"20\" class=\"form-control\"></textarea>\r\n" + 
							"								                                    </div>\r\n" + 
							"								                                  \r\n" + 
							"								                            </div>\r\n" + 
							"								                            <!-- Modal footer -->\r\n" + 
							"								                            <div class=\"modal-footer\">\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-primary\" onclick=\"addViTriLamViec('"+kn.getMaDonVi() +"')\">Thêm</button>\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-danger\" data-bs-dismiss=\"modal\">Close</button>\r\n" + 
							"								                            </div>\r\n" + 
							"															</form>\r\n" + 
							"							\r\n" + 
							"							                        </div>\r\n" + 
							"							                    </div>\r\n" + 
							"							                </div>\r\n" + 
							"			                            </li>");
					
				}
				out.print("</ul>");
	 		}
	 		
		} catch (Exception e) {
			e.printStackTrace();
			
		}
       
    }
    @RequestMapping(value= {"/suaCV/deleteViTriHoatDong"}, method=RequestMethod.POST)
    public void deleteViTriHoatDong(Model model,HttpSession session,HttpServletRequest  request,HttpServletResponse response) {
	 	try {
	 		response.setContentType("text/html;charset=UTF-8");
	 		request.setCharacterEncoding("UTF-8");
	 		
	 		String maViTri= request.getParameter("maViTri");
	 		System.out.println(maViTri);
	 		ArrayList<ViTri> viTris=(ArrayList<ViTri>)session.getAttribute("viTris");
	 		ArrayList<DonVi> hoatDongs=(ArrayList<DonVi>)session.getAttribute("hoatDongs");
	 		
	 		ViTri viTri=null;
	 		for (ViTri vt : viTris) {
				if(vt.getMaViTri()==Long.parseLong(maViTri)) viTri=vt;
			}
	 		viTris.remove(viTri);
	 		session.removeAttribute("viTris");
	 		session.setAttribute("viTris", viTris);
	 		
	 		PrintWriter out=response.getWriter();
	 		
	 		if(!hoatDongs.isEmpty()) {
	 			out.print("<ul >");
				for (DonVi hd : hoatDongs) { 
					out.print("<li>\r\n" + 
							"			                                <div class=\"row\">\r\n" + 
							"			                                	<div class=\"col-11\">\r\n" + 
							"			                                		<b>"+hd.getTenDonVi() +"</b>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                	<div class=\"col-1\">\r\n" + 
							"			                                		<i class=\"fas fa-trash-alt trash\" onclick=\"deleteHoatDong('"+hd.getMaDonVi()+"')\"></i>\r\n" + 
							"			                                	</div>\r\n" + 
							"			                                </div>"); 
					for(ViTri vt:viTris) {
						if(vt.getMaDonVi()==hd.getMaDonVi()) {
							out.print("<div class=\"row mb-3\">\r\n" + 
									"				                                	<div class=\"col-11\">\r\n" + 
									"				                                    <div class=\"row mb-2\"    >\r\n" + 
									"				                                        <div class=\"col-9\">\r\n" + 
									"				                                           <b><i>"+vt.getTenViTri() +"</i></b> \r\n" + 
									"				                                        </div>\r\n" + 
									"				                                        <div class=\"col-3\">\r\n" + vt.getKhoangThoiGian()  + 
									"				                                        </div>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div style=\"margin-left: 20px;\">\r\n" + vt.getMoTa()  + 
									"				                                    </div>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                    <div class=\"col-1\">\r\n" + 
									"				                                    	<i class=\"fas fa-trash-alt trash\" onclick=\"deleteViTriHoatDong('"+vt.getMaViTri()+"')\"></i>\r\n" + 
									"				                                    </div>\r\n" + 
									"				                                </div>");
						}
					}
					out.print("<a href=\"\" data-bs-toggle=\"modal\" data-bs-target=\"#myModalViTriHoatDong"+hd.getMaDonVi() +"\"><i class=\"fas fa-plus-square\"></i> Thêm nhóm, bộ phận, chức vụ hoạt động</a>\r\n" + 
							"			                            	<!-- The Modal vi tri Hoc Van-->\r\n" + 
							"								                <div class=\"modal\" id=\"myModalViTriHoatDong"+hd.getMaDonVi() +"\">\r\n" + 
							"								                    <div class=\"modal-dialog\">\r\n" + 
							"								                        <div class=\"modal-content\">\r\n" + 
							"								                            <!-- Modal Header -->\r\n" + 
							"								                            <div class=\"modal-header\">\r\n" + 
							"								                                <h4 class=\"modal-title\">Thêm Vị Trí Hoạt Động</h4>\r\n" + 
							"								                                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\r\n" + 
							"								                            </div>\r\n" + 
							"								                            <!-- Modal body -->\r\n" + 
							"								                            <form >\r\n" + 
							"								                            <div class=\"modal-body\">\r\n" + 
							"								                                    <div class=\"mb-3 mt-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Vị trí<span class=\"required\">\r\n" + 
							"                                        												*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtViTriHoatDong"+hd.getMaDonVi() +"\" placeholder=\"Trưởng ban văn nghệ\">\r\n" + 
							"								                                    <small id=\"errorViTriHoatDong\" class=\"required\"></small></div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Khoảng thời gian<span class=\"required\">\r\n" + 
							"                                        														*</span></label>\r\n" + 
							"								                                        <input type=\"text\" class=\"form-control\" required=\"required\" id=\"txtKhoangThoiGianHoatDong"+hd.getMaDonVi() +"\" placeholder=\"2018 - Nay\">\r\n" + 
							"								                                    <small id=\"errorKhoangThoiGianHoatDong\" class=\"required\"></small></div>\r\n" + 
							"								                                    <div class=\"mb-3\">\r\n" + 
							"								                                        <label class=\"form-label\">Mô tả:</label>\r\n" + 
							"								                                        <textarea id=\"txtMoTaHoatDong"+hd.getMaDonVi() +"\" rows=\"5\" cols=\"20\" class=\"form-control\"></textarea>\r\n" + 
							"								                                    </div>\r\n" + 
							"								                            </div>\r\n" + 
							"								                            <!-- Modal footer -->\r\n" + 
							"								                            <div class=\"modal-footer\">\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-primary\" onclick=\"addViTriHoatDong('"+hd.getMaDonVi() +"')\">Thêm</button>\r\n" + 
							"								                                <button type=\"button\" class=\"btn btn-danger\" data-bs-dismiss=\"modal\">Close</button>\r\n" + 
							"								                                \r\n" + 
							"								                            </div>\r\n" + 
							"															</form>\r\n" + 
							"								                        </div>\r\n" + 
							"								                    </div>\r\n" + 
							"								                </div>\r\n" + 
							"			                            </li>");
					
				}
				out.print("</ul>");
	 		}
	 		
		} catch (Exception e) {
			e.printStackTrace();
			
		}
       
    }
}

<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@taglib uri="http://www.springframework.org/tags/form" prefix="form"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<c:set var="contextPath" value="${pageContext.request.contextPath}" />
<!DOCTYPE html>
<html>
<head>
	<title>${title }</title>
	<jsp:include page="/WEB-INF/pages/layout/header.jsp" />
</head>
<body>
    <div class="bg">
    <jsp:include page="/WEB-INF/pages/layout/navbar.jsp" />
    <div style="height:70px;">
    </div>
    <div class="container">
    	<div style="height:20px;">
    	</div>
        <form class="row " method="post" onsubmit="return validate();" action="/doanhnghiep/doimatkhau" >
          <h3 style="color: rgb(6, 109, 70);" class="mb-5">Đổi mật khẩu</h3>
            <div class="row mb-3">
              <label for="oldPassword" class="col-sm-2 col-form-label" >Mật khẩu cũ<span class="required"> *</span></label>
              <div class="col-sm-10">
                <input type="password" class="form-control" id="oldPassword" name="txtOldPassword">
                <small id="errorOldPassword" style="color: red;"></small>
              </div>
            </div>
            <div class="row mb-3">
              <label for="newPassword" class="col-sm-2 col-form-label">Mật khẩu mới<span class="required"> *</span></label>
              <div class="col-sm-10">
                <input type="password" class="form-control" id="newPassword" name="txtNewPassword" >
                <small><i><b>Lưu ý: </b>Mật khẩu tối thiểu 8 ký tự, trong đó có ít nhất 1 ký tự chữ thường, 1 ký tự chữ hoa và 1 ký tự số.</i></small>
                <br><small id="errorNewPassword" style="color: red;"></small>
              </div>

            </div>
            <div class="row mb-3">
              <label for="reNewPassword" class="col-sm-2 col-form-label">Xác nhận mật khẩu mới<span class="required"> *</span></label>
              <div class="col-sm-10">
                <input type="password" class="form-control" id="reNewPassword">
                <small id="errorReNewPassword" style="color: red;"></small>
              </div>
            </div>
       
          <div class="row mb-3">
            <div class="col-sm-11 offset-sm-1">
              <button type="submit"  class="btn btn-primary">Đăng ký</button>
            </div>
          </div>
       
      </form>
    </div>
	<jsp:include page="/WEB-INF/pages/layout/footer.jsp" />
    </div>
    
<script>

function setQuanHuyen(){
	var maTinhThanh = document.getElementById("city").value;
	document.getElementById("ward").innerHTML="<option disabled selected>----------</option>";
	$.ajax({ 
	    type:"post", 
	    url: "/doanhnghiep/dangky/quanhuyen", 
	    contentType: "application/x-www-form-urlencoded;charset=utf-8",
	    data: {
	    	maTinhThanh: maTinhThanh,
	    }, 
	    success: function(data) { 
	    	var row = document.getElementById("district");
	    	row.innerHTML += data;
	    	
	    },
	    })
};

function setXaPhuong(){
	var maQuanHuyen = document.getElementById("district").value;
	$.ajax({ 
	    type:"post", 
	    url: "/doanhnghiep/dangky/xaphuong", 
	    contentType: "application/x-www-form-urlencoded;charset=utf-8",
	    data: {
	    	maQuanHuyen: maQuanHuyen,
	    }, 
	    success: function(data) { 
	    	var row = document.getElementById("ward");
	    	row.innerHTML = data;
	    },
	    })
};
function validateThongTinDangNhap(){
	var kt= true;
	var checkEmail= /^[a-zA-Z][a-zA-Z0-9_\.]{5,63}@[a-zA-Z0-9]{2,}(\.[a-zA-Z0-9]{2,4}){1,2}$/;
	var checkPassword= /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}$/;
	
	var email = document.getElementById("email").value;
	var password = document.getElementById("password").value;
	var rePassword = document.getElementById("rePassword").value;
	if(!checkEmail.test(email)) {	
		document.getElementById("errorEmail").innerText="Email không hợp lệ";
		kt=false;
	}
	else document.getElementById("errorEmail").innerText="";
	if(!checkPassword.test(password)) {	
		document.getElementById("errorPassword").innerText="Mật khẩu không hợp lệ";
		kt=false;
	}
	else document.getElementById("errorPassword").innerText="";
	if(rePassword!=password) {	
		document.getElementById("errorRePassword").innerText="Mật khẩu không khớp";
		kt=false;
	}
	else document.getElementById("errorRePassword").innerText="";
	if(kt) currentSlide(1);
};
function validateThongTinLienHe(){
	var kt= true;
	var checkEmail= /^[a-zA-Z][a-zA-Z0-9_\.]{5,63}@[a-zA-Z0-9]{2,}(\.[a-zA-Z0-9]{2,4}){1,2}$/;
	var checkTel= /^0[35789][0-9]{8}$/;
	
	var contactName = document.getElementById("contactName").value;
	var contactEmail = document.getElementById("contactEmail").value;
	var contactTel = document.getElementById("contactTel").value;
	if(!checkEmail.test(contactEmail)) {	
		document.getElementById("errorContactEmail").innerText="Email không hợp lệ";
		kt=false;
	}
	else document.getElementById("errorContactEmail").innerText="";
	if(!checkTel.test(contactTel)) {	
		document.getElementById("errorContactTel").innerText="Số điện thoại không hợp lệ";
		kt=false;
	}
	else document.getElementById("errorContactTel").innerText="";
	if(contactName=="") {	
		document.getElementById("errorContactName").innerText="Tên người liên hệ không được bỏ trống";
		kt=false;
	}
	else document.getElementById("errorContactName").innerText="";
	if(kt) currentSlide(2);
};
function validateThongTinDoanhNghiep(){
	var kt= true;
	var checkTaxCode= /^([0-9]{10}|[0-9]{13})$/;
	
	var enterpriseName = document.getElementById("enterpriseName").value;
	var taxCode = document.getElementById("taxCode").value;
	var city = document.getElementById("city").value;
	var district = document.getElementById("district").value;
	var ward = document.getElementById("ward").value;
	var street = document.getElementById("street").value;
	var field = document.getElementById("field").value;
	var enterpriseType = document.getElementById("enterpriseType").value;
	
	console.log(city);
	if(enterpriseName==""){
		document.getElementById("errorEnterpriseName").innerText="Tên doanh nghiệp không được bỏ trống";
		kt=false;
	}
	else  document.getElementById("errorEnterpriseName").innerText="";
	if(!checkTaxCode.test(taxCode)) {	
		document.getElementById("errorTaxCode").innerText="Mã số thuế không hợp lệ";
		kt=false;
	}
	else document.getElementById("errorTaxCode").innerText="";
	if(city==""){
		document.getElementById("errorCity").innerText="Tỉnh/Thành phố không được bỏ trống";
		kt=false;
	}
	else  document.getElementById("errorCity").innerText="";
	if(district==""){
		document.getElementById("errorDistrict").innerText="Quận/huyện không được bỏ trống";
		kt=false;
	}
	else document.getElementById("errorDistrict").innerText="";
	if(ward==""){
		document.getElementById("errorWard").innerText="Xã/phường/thị trấn không được bỏ trống";
		kt=false;
	}
	else document.getElementById("errorWard").innerText="";
	if(street==""){
		document.getElementById("errorStreet").innerText="Địa chỉ đường không được bỏ trống";
		kt=false;
	}
	else document.getElementById("errorStreet").innerText="";
	if(field==""){
		document.getElementById("errorField").innerText="Lĩnh vực hoạt động không được bỏ trống";
		kt=false;
	}
	else document.getElementById("errorField").innerText="";
	if(enterpriseType==""){
		document.getElementById("errorEnterpriseType").innerText="Loại hình doanh nghiệp không được bỏ trống";
		kt=false;
	}
	else document.getElementById("errorEnterpriseType").innerText="";
	
	
	if(kt) currentSlide(3);
};
function checkEmailDangNhap(){
	var email = document.getElementById("email").value;
	var kt=false;
	$.ajax({ 
	    type:"post", 
	    url: "/doanhnghiep/dangky/checkemaildangnhap", 
	    contentType: "application/x-www-form-urlencoded;charset=utf-8",
	    data: {
	    	email: email,
	    }, 
	    async: false,
	    success: function(data) { 
	    	console.log(data);
	    	var x=document.getElementById("msgCheckEmail");
	    	if(data=="true"){
	    		x.className="alert alert-danger alert-dismissible mt-3 d-block"; 
	    		kt=false;
	    	}
	    	else {
	    		x.className="alert alert-danger alert-dismissible mt-3 d-none";
	    		kt=true;
	    	}
	    },
	    })
	console.log(kt);
	  return kt;
};
</script>
</body>
</html>